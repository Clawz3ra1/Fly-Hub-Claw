-- Variáveis principais
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local flying = false
local flySpeed = 50  -- Velocidade inicial do voo

-- Criando a UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FlyGui"
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Criando o botão "Ativar Fly"
local flyButton = Instance.new("TextButton")
flyButton.Name = "FlyButton"
flyButton.Size = UDim2.new(0, 200, 0, 50)
flyButton.Position = UDim2.new(0, 20, 0, 20)
flyButton.Text = "Ativar Fly"
flyButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
flyButton.Font = Enum.Font.SourceSans
flyButton.TextSize = 24
flyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
flyButton.Parent = screenGui

-- Criando o slider de velocidade
local speedSlider = Instance.new("TextBox")
speedSlider.Name = "SpeedSlider"
speedSlider.Size = UDim2.new(0, 200, 0, 50)
speedSlider.Position = UDim2.new(0, 20, 0, 80)
speedSlider.Text = "Velocidade: 50"
speedSlider.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
speedSlider.Font = Enum.Font.SourceSans
speedSlider.TextSize = 20
speedSlider.TextColor3 = Color3.fromRGB(255, 255, 255)
speedSlider.Parent = screenGui

-- Função para iniciar o voo
local function startFlying()
    if not flying then
        flying = true
        humanoid.PlatformStand = true
        humanoidRootPart.Anchored = true

        -- Criação do BodyVelocity para movimento no ar
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(10000, 10000, 10000)
        bodyVelocity.Velocity = Vector3.new(0, 0, 0)
        bodyVelocity.Parent = humanoidRootPart
        
        -- Enquanto o voo estiver ativado, o personagem vai se mover em direção ao mouse
        while flying do
            local direction = (mouse.Hit.p - humanoidRootPart.Position).unit
            bodyVelocity.Velocity = Vector3.new(direction.X, 0, direction.Z) * flySpeed
            wait(0.1)
        end
        
        bodyVelocity:Destroy()  -- Remove o bodyVelocity quando o voo for desativado
        humanoid.PlatformStand = false
        humanoidRootPart.Anchored = false
    end
end

-- Função para parar o voo
local function stopFlying()
    flying = false
end

-- Toggle de voo ao clicar no botão
flyButton.MouseButton1Click:Connect(function()
    if flying then
        stopFlying()
        flyButton.Text = "Ativar Fly"
    else
        startFlying()
        flyButton.Text = "Desativar Fly"
    end
end)

-- Atualiza a velocidade do voo com o slider de texto
speedSlider.FocusLost:Connect(function()
    local newSpeed = tonumber(speedSlider.Text)
    if newSpeed and newSpeed > 0 then
        flySpeed = newSpeed
        speedSlider.Text = "Velocidade: " .. flySpeed
    else
        speedSlider.Text = "Velocidade: " .. flySpeed  -- Restaura a velocidade se a entrada for inválida
    end
end)
